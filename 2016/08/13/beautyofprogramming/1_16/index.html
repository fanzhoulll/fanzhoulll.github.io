<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>24 Game | Fan Zhou</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Problem: Design an algorithm, find solution for 24 game.
 Solution: Abstractly, what we need to do is to use +, -, *, /, (, ) to construct formulas with the a 4-number array A=[a, b, c, d], so that th">
<meta property="og:type" content="article">
<meta property="og:title" content="24 Game">
<meta property="og:url" content="http://yoursite.com/2016/08/13/beautyofprogramming/1_16/index.html">
<meta property="og:site_name" content="Fan Zhou">
<meta property="og:description" content="Problem: Design an algorithm, find solution for 24 game.
 Solution: Abstractly, what we need to do is to use +, -, *, /, (, ) to construct formulas with the a 4-number array A=[a, b, c, d], so that th">
<meta property="og:updated_time" content="2016-08-13T12:46:50.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="24 Game">
<meta name="twitter:description" content="Problem: Design an algorithm, find solution for 24 game.
 Solution: Abstractly, what we need to do is to use +, -, *, /, (, ) to construct formulas with the a 4-number array A=[a, b, c, d], so that th">
  
    <link rel="alternate" href="/atom.xml" title="Fan Zhou" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  

</head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Fan Zhou</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-beautyofprogramming/1_16" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/08/13/beautyofprogramming/1_16/" class="article-date">
  <time datetime="2016-08-13T08:25:14.000Z" itemprop="datePublished">2016-08-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/The-Art-of-Algorithm/">The Art of Algorithm</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      24 Game
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><em>Problem:</em> Design an algorithm, find solution for <a href="https://en.wikipedia.org/wiki/24_Game" target="_blank" rel="external">24 game</a>.</p>
<p> <em>Solution:</em> Abstractly, what we need to do is to use <code>+, -, *, /, (, )</code> to construct formulas with the a 4-number array <em>A=[a, b, c, d]</em>, so that the result is 24. The simplest solution is brute force. We can try all different combinations of number sequence, arithmetic operators and brackets to find the solution.</p>
<p>we can use following recursive steps to solve the problem:</p>
<ol>
<li>Choose two numbers <em>a</em>, <em>b</em>, compute <em>a+b</em>.</li>
<li>Put <em>a+b</em> back to the <em>A</em> and delete <em>a</em>,<em>b</em>, get a new array <em>A’ = [a+b, c, d]</em>.</li>
<li>Back to Step 1 with <em>A’</em></li>
</ol>
<p>Of course, in step 1 we should also compute <em>a-b, b-a, a*b, a/b (b!=0), b/a (a!=0)</em> to get the result.</p>
<p>While the idea is simple, the program itself is error-prone. I made (at least) following four mistakes when try to implement it:</p>
<ol>
<li>It is possible that the final result is not integer 24, but a floating point number that very close to 24 (because of division operation in solution).</li>
<li>We should choose every possible combination of <em>a</em> and <em>b</em> in set <em>A</em> (step 1). Naively choose first and second element does not work.</li>
<li>After we iterate over all possible operators yet still cannot find a solution, we should restore set <em>A</em> from <em>A’</em> and try other elements. In above example example, we should recover set <em>A’ = [f(a, b), c, d]</em> to <em>A = [a, b, c, d]</em>, where <em>f(a, b)</em> is an operation on <em>a</em> and <em>b</em>.</li>
<li>To easily recover <em>A</em>, we do not really need to delete element <em>a</em> and <em>b</em> in set <em>A</em>.  Instead, we can replace <em>a</em> with <em>a+b</em> and replace <em>b</em> with the last element in the input array. Then we could recursive call the solution search function on the array except the last element (<em>b</em>).</li>
</ol>
<p>The complete python code is shown as followings:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">nums = [<span class="number">1</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</div><div class="line">results = map(str, nums)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve24game</span><span class="params">(nums)</span>:</span></div><div class="line">    <span class="comment"># Recursive terminate condition: &lt;=1 element left</span></div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> nums:</div><div class="line">        <span class="keyword">return</span></div><div class="line">    <span class="keyword">if</span> len(nums) == <span class="number">1</span>:</div><div class="line">        <span class="keyword">if</span> abs(nums[<span class="number">0</span>] - <span class="number">24</span>) &lt; <span class="number">0.0001</span>:</div><div class="line">            <span class="keyword">print</span> results[<span class="number">0</span>][<span class="number">1</span>:<span class="number">-1</span>]</div><div class="line">        <span class="keyword">return</span></div><div class="line">    n = len(nums)</div><div class="line">    <span class="comment"># Iterate over every possible combination of i and j</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, n):</div><div class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i+<span class="number">1</span>, n):</div><div class="line">            a = nums[i]</div><div class="line">            b = nums[j]</div><div class="line">            res_a = results[i]</div><div class="line">            res_b = results[j]</div><div class="line">            <span class="comment"># Replace nums[i] with a+b</span></div><div class="line">            nums[i] = a+b</div><div class="line">            <span class="comment"># Replace nums[j] with last elem</span></div><div class="line">            nums[j] = nums[n<span class="number">-1</span>]</div><div class="line">            results[j] = results[n<span class="number">-1</span>]</div><div class="line">            <span class="comment"># Replace results[i] with results[i] + results[j]</span></div><div class="line">            results[i] = <span class="string">'('</span> + res_a + <span class="string">'+'</span> + res_b + <span class="string">')'</span></div><div class="line">            solve24game(nums[<span class="number">0</span>:(n<span class="number">-1</span>)])</div><div class="line">            nums[i] = a-b</div><div class="line">            results[i] = <span class="string">'('</span> + res_a + <span class="string">'-'</span> + res_b + <span class="string">')'</span></div><div class="line">            solve24game(nums[<span class="number">0</span>:(n<span class="number">-1</span>)])</div><div class="line">            nums[i] = b-a</div><div class="line">            results[i] = <span class="string">'('</span> + res_b + <span class="string">'-'</span> + res_a + <span class="string">')'</span></div><div class="line">            solve24game(nums[<span class="number">0</span>:(n<span class="number">-1</span>)])</div><div class="line">            results[i] = <span class="string">'('</span> + res_a + <span class="string">'*'</span> + res_b + <span class="string">')'</span></div><div class="line">            nums[i] = a*b</div><div class="line">            solve24game(nums[<span class="number">0</span>:(n<span class="number">-1</span>)])</div><div class="line">            <span class="keyword">if</span> a != <span class="number">0</span>:</div><div class="line">                results[i] = <span class="string">'('</span> + res_b + <span class="string">'/'</span> + res_a + <span class="string">')'</span></div><div class="line">                nums[i] = float(b)/a</div><div class="line">                solve24game(nums[<span class="number">0</span>:(n<span class="number">-1</span>)])</div><div class="line">            <span class="keyword">if</span> b != <span class="number">0</span>:</div><div class="line">                results[i] = <span class="string">'('</span> + res_a + <span class="string">'/'</span> + res_b + <span class="string">')'</span></div><div class="line">                nums[i] = float(a)/b</div><div class="line">                solve24game(nums[<span class="number">0</span>:(n<span class="number">-1</span>)])</div><div class="line">            <span class="comment"># Recover original array</span></div><div class="line">            nums[i] = a</div><div class="line">            nums[j] = b</div><div class="line">            results[i] = res_a</div><div class="line">            results[j] = res_b</div><div class="line"></div><div class="line"><span class="comment"># Test</span></div><div class="line">solve24game(nums)</div></pre></td></tr></table></figure>
<p>The key takeaway from this problem is the writing of recursive program. Think carefully about the termination condition, how to reduce problem size in each iteration and how to restore the previous stage after all iterations are over.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/08/13/beautyofprogramming/1_16/" data-id="cis3bp1as0008xal9c6mp2r8x" class="article-share-link">Share</a>
      
        <a href="http://yoursite.com/2016/08/13/beautyofprogramming/1_16/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algorithm/">algorithm</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/08/16/programmingpearls/column10/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Squeezing Space (column 10)
        
      </div>
    </a>
  
  
    <a href="/2016/08/09/beautyofprogramming/1_8/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Elevator scheduling</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Notes-of-Programming-Pearls/">Notes of Programming Pearls</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Programming-tricks/">Programming tricks</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/The-Art-of-Algorithm/">The Art of Algorithm</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/">algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/programming-pearls/">programming pearls</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/algorithm/" style="font-size: 15px;">algorithm</a> <a href="/tags/programming-pearls/" style="font-size: 20px;">programming pearls</a> <a href="/tags/python/" style="font-size: 10px;">python</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/08/20/network/test/">Cracking the Oyster (column 1)</a>
          </li>
        
          <li>
            <a href="/2016/08/19/programmingpearls/column12/">A Sample Problem (column 11)</a>
          </li>
        
          <li>
            <a href="/2016/08/18/programmingpearls/column11/">Sorting (column 11)</a>
          </li>
        
          <li>
            <a href="/2016/08/16/programmingpearls/column10/">Squeezing Space (column 10)</a>
          </li>
        
          <li>
            <a href="/2016/08/13/beautyofprogramming/1_16/">24 Game</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Fan Zhou<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'fanzhoulll';
  
  var disqus_url = 'http://yoursite.com/2016/08/13/beautyofprogramming/1_16/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>