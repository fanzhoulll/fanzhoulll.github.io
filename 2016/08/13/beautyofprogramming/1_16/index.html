<!DOCTYPE html>
<html lang="en">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>24 Game | Fan Zhou</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Problem: Design an algorithm, find solution for 24 game.
 Solution: Abstractly, what we need to do is to use +, -, *, /, (, ) to construct formulas with the a 4-number array A=[a, b, c, d], so that th">
<meta property="og:type" content="article">
<meta property="og:title" content="24 Game">
<meta property="og:url" content="http://fanzhoulll.github.io/2016/08/13/beautyofprogramming/1_16/index.html">
<meta property="og:site_name" content="Fan Zhou">
<meta property="og:description" content="Problem: Design an algorithm, find solution for 24 game.
 Solution: Abstractly, what we need to do is to use +, -, *, /, (, ) to construct formulas with the a 4-number array A=[a, b, c, d], so that th">
<meta property="og:updated_time" content="2016-08-13T12:46:50.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="24 Game">
<meta name="twitter:description" content="Problem: Design an algorithm, find solution for 24 game.
 Solution: Abstractly, what we need to do is to use +, -, *, /, (, ) to construct formulas with the a 4-number array A=[a, b, c, d], so that th">
  
    <link rel="alternate" href="/atom.xml" title="Fan Zhou" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/typing.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container" class="container">
    <article id="post-beautyofprogramming/1_16" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      24 Game
    </h1>
  

      </header>
    
    <div class="article-entry typo" itemprop="articleBody">
      
        <p><em>Problem:</em> Design an algorithm, find solution for <a href="https://en.wikipedia.org/wiki/24_Game" target="_blank" rel="external">24 game</a>.</p>
<p> <em>Solution:</em> Abstractly, what we need to do is to use <code>+, -, *, /, (, )</code> to construct formulas with the a 4-number array <em>A=[a, b, c, d]</em>, so that the result is 24. The simplest solution is brute force. We can try all different combinations of number sequence, arithmetic operators and brackets to find the solution.</p>
<p>we can use following recursive steps to solve the problem:</p>
<ol>
<li>Choose two numbers <em>a</em>, <em>b</em>, compute <em>a+b</em>.</li>
<li>Put <em>a+b</em> back to the <em>A</em> and delete <em>a</em>,<em>b</em>, get a new array <em>A’ = [a+b, c, d]</em>.</li>
<li>Back to Step 1 with <em>A’</em></li>
</ol>
<p>Of course, in step 1 we should also compute <em>a-b, b-a, a*b, a/b (b!=0), b/a (a!=0)</em> to get the result.</p>
<p>While the idea is simple, the program itself is error-prone. I made (at least) following four mistakes when try to implement it:</p>
<ol>
<li>It is possible that the final result is not integer 24, but a floating point number that very close to 24 (because of division operation in solution).</li>
<li>We should choose every possible combination of <em>a</em> and <em>b</em> in set <em>A</em> (step 1). Naively choose first and second element does not work.</li>
<li>After we iterate over all possible operators yet still cannot find a solution, we should restore set <em>A</em> from <em>A’</em> and try other elements. In above example example, we should recover set <em>A’ = [f(a, b), c, d]</em> to <em>A = [a, b, c, d]</em>, where <em>f(a, b)</em> is an operation on <em>a</em> and <em>b</em>.</li>
<li>To easily recover <em>A</em>, we do not really need to delete element <em>a</em> and <em>b</em> in set <em>A</em>.  Instead, we can replace <em>a</em> with <em>a+b</em> and replace <em>b</em> with the last element in the input array. Then we could recursive call the solution search function on the array except the last element (<em>b</em>).</li>
</ol>
<p>The complete python code is shown as followings:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">nums = [<span class="number">1</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</div><div class="line">results = map(str, nums)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve24game</span><span class="params">(nums)</span>:</span></div><div class="line">    <span class="comment"># Recursive terminate condition: &lt;=1 element left</span></div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> nums:</div><div class="line">        <span class="keyword">return</span></div><div class="line">    <span class="keyword">if</span> len(nums) == <span class="number">1</span>:</div><div class="line">        <span class="keyword">if</span> abs(nums[<span class="number">0</span>] - <span class="number">24</span>) &lt; <span class="number">0.0001</span>:</div><div class="line">            <span class="keyword">print</span> results[<span class="number">0</span>][<span class="number">1</span>:<span class="number">-1</span>]</div><div class="line">        <span class="keyword">return</span></div><div class="line">    n = len(nums)</div><div class="line">    <span class="comment"># Iterate over every possible combination of i and j</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, n):</div><div class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i+<span class="number">1</span>, n):</div><div class="line">            a = nums[i]</div><div class="line">            b = nums[j]</div><div class="line">            res_a = results[i]</div><div class="line">            res_b = results[j]</div><div class="line">            <span class="comment"># Replace nums[i] with a+b</span></div><div class="line">            nums[i] = a+b</div><div class="line">            <span class="comment"># Replace nums[j] with last elem</span></div><div class="line">            nums[j] = nums[n<span class="number">-1</span>]</div><div class="line">            results[j] = results[n<span class="number">-1</span>]</div><div class="line">            <span class="comment"># Replace results[i] with results[i] + results[j]</span></div><div class="line">            results[i] = <span class="string">'('</span> + res_a + <span class="string">'+'</span> + res_b + <span class="string">')'</span></div><div class="line">            solve24game(nums[<span class="number">0</span>:(n<span class="number">-1</span>)])</div><div class="line">            nums[i] = a-b</div><div class="line">            results[i] = <span class="string">'('</span> + res_a + <span class="string">'-'</span> + res_b + <span class="string">')'</span></div><div class="line">            solve24game(nums[<span class="number">0</span>:(n<span class="number">-1</span>)])</div><div class="line">            nums[i] = b-a</div><div class="line">            results[i] = <span class="string">'('</span> + res_b + <span class="string">'-'</span> + res_a + <span class="string">')'</span></div><div class="line">            solve24game(nums[<span class="number">0</span>:(n<span class="number">-1</span>)])</div><div class="line">            results[i] = <span class="string">'('</span> + res_a + <span class="string">'*'</span> + res_b + <span class="string">')'</span></div><div class="line">            nums[i] = a*b</div><div class="line">            solve24game(nums[<span class="number">0</span>:(n<span class="number">-1</span>)])</div><div class="line">            <span class="keyword">if</span> a != <span class="number">0</span>:</div><div class="line">                results[i] = <span class="string">'('</span> + res_b + <span class="string">'/'</span> + res_a + <span class="string">')'</span></div><div class="line">                nums[i] = float(b)/a</div><div class="line">                solve24game(nums[<span class="number">0</span>:(n<span class="number">-1</span>)])</div><div class="line">            <span class="keyword">if</span> b != <span class="number">0</span>:</div><div class="line">                results[i] = <span class="string">'('</span> + res_a + <span class="string">'/'</span> + res_b + <span class="string">')'</span></div><div class="line">                nums[i] = float(a)/b</div><div class="line">                solve24game(nums[<span class="number">0</span>:(n<span class="number">-1</span>)])</div><div class="line">            <span class="comment"># Recover original array</span></div><div class="line">            nums[i] = a</div><div class="line">            nums[j] = b</div><div class="line">            results[i] = res_a</div><div class="line">            results[j] = res_b</div><div class="line"></div><div class="line"><span class="comment"># Test</span></div><div class="line">solve24game(nums)</div></pre></td></tr></table></figure>
<p>The key takeaway from this problem is the writing of recursive program. Think carefully about the termination condition, how to reduce problem size in each iteration and how to restore the previous stage after all iterations are over.</p>

      
    </div>
    <footer class="article-footer">
      <ul class="article-meta">
        <li>
          <span class="label">Published Date:</span>
          <a href="/2016/08/13/beautyofprogramming/1_16/" class="article-date">
  <time datetime="2016-08-13T08:25:14.000Z" itemprop="datePublished">2016-08-13</time>
</a>

        </li>
        
          <li>
            <span class="label">Categoría:</span>
            
  <div class="article-category">
    <a class="article-category-link" href="/categories/The-Art-of-Algorithm/">The Art of Algorithm</a>
  </div>


          </li>
        
        
          <li>
            <span class="label">Tag:</span>
            
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algorithm/">algorithm</a></li></ul>


          </li>
        
        <hr/>
      </ul>
    </footer>
  </div>
  
    
<nav id="article-nav" class="article-nav">
  
    <a href="/2016/08/16/programmingpearls/column10/" id="article-nav-newer" class="article-nav-link-wrap newer">
      <strong class="article-nav-caption">Nuevo</strong>
      <div class="article-nav-title">
        
          Squeezing Space (column 10)
        
      </div>
    </a>
  
  
    <a href="/2016/08/09/beautyofprogramming/1_8/" id="article-nav-older" class="article-nav-link-wrap older">
      <strong class="article-nav-caption">Viejo</strong>
      <div class="article-nav-title">Elevator scheduling</div>
    </a>
  
</nav>


  
</article>


  <section id="comments" class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
  </section>


  </div>
  
    <footer id="footer" class="post-footer footer">
      <hr/>
      <div id="footerContent" class="footer-content">
        <p>ipsum dolor sit amet, <strong>consectetur adipiscing elit.</strong> Fusce eget urna vitae velit <em>eleifend interdum at ac nisi. In nec ligula lacus. Cum sociis natoque</em> penatibus et magnis dis parturient montes, nascetur ridiculus mus. Sed eu cursus erat, ut dapibus quam. Post</p>


      </div>
    </footer>

  
  <script>
   var disqus_shortname = 'fanzhoulll';
   
   var disqus_url = 'http://fanzhoulll.github.io/2016/08/13/beautyofprogramming/1_16/';
   
   (function(){
     var dsq = document.createElement('script');
     dsq.type = 'text/javascript';
     dsq.async = true;
     dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
     (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
   })();
  </script>


<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/typing.js"></script>
<!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->







  </div><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>
